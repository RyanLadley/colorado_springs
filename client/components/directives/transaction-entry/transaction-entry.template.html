<form class = "entry-form " name = "entryForm">
    <div ng-class = "navLocation(firstpage, false)" class ="nav-content">

        <div class = "tab-title" ng-if = "!transaction.transactionId">
            <div class = "title-info">
                <h2>New Transactions</h2>
                <info-tip message = "Use this tab to create a new transaction. All fields but the 'Date Paid' are required for input."></info-tip>
            </div>
        </div>

        <div class = "tab-title" ng-if = "transaction.transactionId">
            <div class = "title-info">
                <h2>To</h2>
                <info-tip message = "The row above shows the existing entry. Use the inputs bellow to change this transaction and press submit to save."></info-tip>
            </div>
        </div>

        <div class = "input-row">
            <account-select account-id = "transaction.accountId" accounts = "accounts"></account-select>
        </div>
        
        <div class = "input-row">
            <div class = "label-input">
                <label>Vendor</label>
                <select ng-model = "transaction.vendorId" ng-options = "vendor.vendor_id as vendor.name for vendor in vendors"  required>
                    <option value="" disabled selected hidden>Select a Vendor</option>
                </select>
            </div>

            <div class = "label-input">
                <label>Invoice Number</label>
                <input type = "text" placeholder = "Invoice Number" class = "invoice-textfield" ng-model = "transaction.invoiceNo"  required>
            </div>

            <div class = "label-input">
                <label>Transaction Type</label>
                <select ng-model = "transaction.transactionTypeId" ng-options = "type.transaction_type_id as type.transaction_type for type in transactionTypes"  required>
                    <option value="" disabled selected hidden>Select a Type</option>
                </select>
            </div>
            
            <date-select label ="Invoice Date"  date = "transaction.invoiceDate" input-disabled = "true" required = "true"></date-select>

            <date-select label ="Date Paid (optional)"  date = "transaction.datePaid" input-disabled = "true" info = "Leaving this blank will create 'Pending' transaction. This is resolved in the 'adjustments' screen"></date-select>

            <div class = "label-input">
                <label>Total Expense</label>
                <div class = "dollar-input">
                    <i class="fa fa-usd" aria-hidden="true"></i>
                    <input type="Number" placeholder="Enter a Dollar Amount" step="0.01" ng-model = "transaction.expense" required>
                </div>
            </div>
        </div>

        <div class = "label-input input-row">
            <label>Description</label>
            <textarea placeholder="Enter Discription" ng-model = "transaction.description" required></textarea>
        </div>


        <button class="to-button transition-button" ng-click = "incrementPage(); setupCityAccounts()" ng-disabled = "entryForm.$invalid" formnovalidate>Proceed to City Accounts<i class="fa fa-chevron-right" aria-hidden="true"></i></button>
    </div>

    <div ng-class = "navLocation(firstpage+1, true)" class = "nav-content scrolable-tabed-content">
        <div class = "tab-title">
            <div class = "title-info">
                <h2>City Account Codes</h2>
                <info-tip message = "Add the proper city codes to this transaction to be used on coversheets."></info-tip>
            </div>
        </div>
        <div ng-repeat ="cityAccount in transaction.cityAccounts">
            <div class = "input-row">
                <div class = "label-input">
                    <label>City Account</label>
                    <select ng-model = "transaction.cityAccounts[$index].cityAccountId" 
                            ng-options = "account.city_account_id as [account.account_no,account.title].join(' - ') for account in cityAccounts">
                        <option value="" selected >Unassigned</option>
                    </select>
                </div>
                <div class = "label-input">
                    <label>Amount</label>
                    <div class = "dollar-input">
                        <i class="fa fa-usd" aria-hidden="true"></i>
                        <input type="Number" placeholder="Enter a Dollar Amount" step="0.01" ng-model = "transaction.cityAccounts[$index].amount" ng-change = "checkRemaining()"> 
                    </div>
                </div>
            </div>
        </div>
        <button ng-click = "addAccount()" ng-disabled = "remaining <= 0" class = "add-button"> Add Account </button>

        <div class = "city-account-totals">
            <div class = "label-display">
                <label>Total Expense</label>
                <p>{{transaction.expense |  currency}}</p>
            </div>
            <div class = "label-display">
                <label>Remaining Unassigned</label>
                <p>{{remaining |  currency}}</p>
            </div>
        </div>
            
        <button class="from-button transition-button" ng-click = "decrementPage();" formnovalidate><i class="fa fa-chevron-left" aria-hidden="true"></i>Back To Transactions</button>

        <button class = "entry-submit" ng-click = "submitTransaction()">Submit</button>
    </div>
   
</form>